angular.module("project",[]).controller("AppController",function(e){$.fn.serializeObject=function(){var e={},o=this.serializeArray();return $.each(o,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},e.db=window.openDatabase("questionario","1.0","Questionario DB",1e6),e.salvarClick=function(){var o=$("form").serializeArray(),t=JSON.stringify($("form").serializeObject());e.insertItemDB(t)},e.saveDataLocal=function(e){var o=localStorage.getItem("dados");return"undefined"==typeof o&&(o=[]),console.log(o),o.push("teste"),localStorage.setItem("dados",o),!0},e.saveFile=function(e,o,t){function n(o){o.root.getFile(e,{create:!0},i,a)}function i(e){e.createWriter(r,a)}function r(e){e.onwriteend=function(o){console.log("finished writing"),void 0!==t&&t(e)},e.write(o)}function a(e){console.log("Error: ",e.code)}var c="export-file.txt";(void 0===e||null===e)&&(e=c),window.requestFileSystem(LocalFileSystem.PERSISTENT,0,n,a)},e.convertToCSV=function(e){for(var o="object"!=typeof e?JSON.parse(e):e,t="",n=0;n<o.length;n++){var i="";for(var r in o[n])""!=i&&(i+=","),i+=o[n][r];t+=i+"\r\n"}return t},e.insertItemDB=function(o){function t(e){e.executeSql("DROP TABLE IF EXISTS DADOS"),e.executeSql("CREATE TABLE IF NOT EXISTS DADOS (id unique, data)"),e.executeSql("INSERT INTO DADOS (id, data) VALUES (1,'"+o+"')")}function n(e){console.log(e)}function i(){console.log("Gravado no Banco!")}e.db.transaction(t,n,i)},e.getItensFromDB=function(){function o(e){e.executeSql("SELECT * FROM DADOS",[],n,t)}function t(e){alert("Error processing SQL: "+e)}function n(e,o){var t=o.rows.length;console.log("DADOS table: "+t+" rows found.");for(var n=0;t>n;n++)console.log("Row = "+n+" ID = "+o.rows.item(n).id+" Data =  "+o.rows.item(n).data)}e.db.transaction(o,t)}});